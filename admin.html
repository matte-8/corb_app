<!DOCTYPE html>
<html lang="it">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Admin - U.S. Corbiolo C5</title>
  <link rel="stylesheet" href="css/style.css" />
  <style>
    body { font-family: sans-serif; background: #2d0b0b; color: white; padding-top: 80px; max-width: 600px; margin: 0 auto; }
    .header { background: #660000; color: white; position: fixed; top: 0; width: 100%; display: flex; justify-content: space-between; align-items: center; padding: 10px 16px; z-index: 999; }
    .logo { height: 40px; }
    .menu-icon { font-size: 24px; cursor: pointer; }
    .section { margin: 14px; padding: 12px; background: #801e1e; border-radius: 8px; }
    .section-title { font-size: 18px; font-weight: bold; margin-bottom: 10px; cursor: pointer; }
    .collapsed .section-body { display: none; }
    .section input, .section textarea, .section select {
      width: 100%; margin-bottom: 8px; padding: 8px; border-radius: 4px; border: none; font-size: 15px;
    }
    .section button {
      padding: 8px 12px; border: none; border-radius: 4px; cursor: pointer; margin-right: 6px;
    }
    .btn-yellow { background: #ffcc00; color: black; }
    .btn-red { background: crimson; color: white; }
    #passwordPrompt {
      position: fixed; top: 0; left: 0; right: 0; bottom: 0;
      background: rgba(0,0,0,0.9); color: white; display: flex; flex-direction: column;
      justify-content: center; align-items: center; z-index: 2000;
    }
    #passwordPrompt input { padding: 10px; font-size: 16px; margin-top: 10px; }
    #passwordPrompt button { padding: 10px 20px; margin-top: 10px; }
    .item-group { margin-bottom: 16px; padding: 10px; border: 1px solid #999; border-radius: 6px; }
    .item-group input, .item-group textarea { background: #fff; color: #000; }
  </style>
</head>
<body>
  <!-- PASSWORD PROTECTION -->
  <div id="passwordPrompt">
    <h2>Accesso Admin</h2>
    <input type="password" id="adminPass" placeholder="Inserisci password" />
    <button onclick="checkPassword()">Accedi</button>
  </div>

  <div id="adminContent" style="display:none">
    <header class="header">
      <img src="img/logo.png" alt="Logo" class="logo" />
      <h1 class="page-title">Admin</h1>
      <div class="menu-icon" onclick="toggleMenu()">‚ò∞</div>
    </header>

    <!-- MENU -->
    <div class="popup-menu" id="popupMenu">
      <a href="index.html">üè† Home</a>
      <a href="news.html">üóûÔ∏è News</a>
      <a href="squadra.html">üë• Squadra</a>
      <a href="partite.html">‚öΩÔ∏è Partite</a>
      <a href="calendario.html">üóì Calendario</a>
      <a href="sponsor.html">üí∞ Sponsor</a>
      <a href="admin.html">üîê Admin</a>
    </div>

    <!-- SEZIONI -->
    <div class="section" id="sectionNews">
      <div class="section-title" onclick="toggleSection(this)">üóûÔ∏è News</div>
      <div class="section-body">
        <input type="text" id="newsTitle" placeholder="Titolo" />
        <textarea id="newsText" placeholder="Contenuto"></textarea>
        <button class="btn-yellow" onclick="addItem('news')">Salva</button>
        <div id="newsList"></div>
      </div>
    </div>

    <div class="section" id="sectionGiocatori">
      <div class="section-title" onclick="toggleSection(this)">üë• Giocatori</div>
      <div class="section-body">
        <input type="text" id="giocNome" placeholder="Nome" />
        <input type="text" id="giocRuolo" placeholder="Ruolo" />
        <input type="number" id="giocNumero" placeholder="Numero" />
        <input type="text" id="giocFoto" placeholder="Foto (es: nome.png)" />
        <button class="btn-yellow" onclick="addItem('giocatori')">Salva</button>
        <div id="giocatoriList"></div>
      </div>
    </div>

    <div class="section" id="sectionSponsor">
      <div class="section-title" onclick="toggleSection(this)">üí∞ Sponsor</div>
      <div class="section-body">
        <input type="text" id="sponsorNome" placeholder="Nome" />
        <input type="text" id="sponsorLogo" placeholder="Logo (es: logo.png)" />
        <input type="text" id="sponsorLink" placeholder="Link (facoltativo)" />
        <button class="btn-yellow" onclick="addItem('sponsor')">Salva</button>
        <div id="sponsorList"></div>
      </div>
    </div>

    <div class="section" id="sectionPartite">
      <div class="section-title" onclick="toggleSection(this)">‚öΩÔ∏è Partite</div>
      <div class="section-body">
        <input type="date" id="partitaData" />
        <input type="time" id="partitaOra" />
        <input type="text" id="partitaCasa" placeholder="Squadra Casa" />
        <input type="text" id="partitaLogoCasa" placeholder="Logo Casa" />
        <input type="text" id="partitaFuori" placeholder="Squadra Fuori" />
        <input type="text" id="partitaLogoFuori" placeholder="Logo Fuori" />
        <input type="text" id="partitaRisultato" placeholder="Risultato (es: 3-2)" />
        <input type="text" id="partitaMVP" placeholder="MVP (facoltativo)" />
        <button class="btn-yellow" onclick="addItem('partite')">Salva</button>
        <div id="partiteList"></div>
      </div>
    </div>

    <div class="section" id="sectionCalendario">
      <div class="section-title" onclick="toggleSection(this)">üóì Calendario</div>
      <div class="section-body">
        <input type="date" id="calData" />
        <input type="text" id="calAvversario" placeholder="Avversario" />
        <select id="calCasaFuori">
          <option value="casa">Casa</option>
          <option value="fuori">Fuori</option>
        </select>
        <button class="btn-yellow" onclick="addItem('calendario')">Salva</button>
        <div id="calendarioList"></div>
      </div>
    </div>
  </div>

  <script>
    // --- AUTH ---
    function checkPassword() {
      const p = document.getElementById("adminPass").value;
      if (p === "corb25") {
        document.getElementById("passwordPrompt").style.display = "none";
        document.getElementById("adminContent").style.display = "block";
        loadAll();
      } else {
        alert("Password errata");
      }
    }

    // --- TOGGLE MENU ---
    function toggleMenu() {
      const m = document.getElementById("popupMenu");
      m.style.display = m.style.display === "flex" ? "none" : "flex";
    }

    // --- TOGGLE SECTIONS ---
    function toggleSection(el) {
      el.parentElement.classList.toggle("collapsed");
    }

    // --- SAVE GENERIC ITEM ---
    function addItem(type) {
      const inputs = {
        news: { titolo: "newsTitle", contenuto: "newsText", nuova: "TRUE", img: "" },
        giocatori: { nome: "giocNome", ruolo: "giocRuolo", numero: "giocNumero", foto: "giocFoto" },
        sponsor: { nome: "sponsorNome", logo: "sponsorLogo", link: "sponsorLink" },
        partite: {
          data: "partitaData", ora: "partitaOra", casa: "partitaCasa", logocasa: "partitaLogoCasa",
          fuori: "partitaFuori", logoavv: "partitaLogoFuori", risultato: "partitaRisultato", mvp: "partitaMVP"
        },
        calendario: { data: "calData", avversario: "calAvversario", casa_fuori: "calCasaFuori" }
      };
      const template = inputs[type];
      const item = {};
      for (let key in template) {
        const id = template[key];
        item[key] = document.getElementById(id).value.trim();
      }
      const storage = localStorage.getItem(type) || "[]";
      const arr = JSON.parse(storage);
      arr.unshift(item);
      localStorage.setItem(type, JSON.stringify(arr));
      alert("Dati salvati in " + type);
      loadAll();
    }

    // --- LOAD ALL ITEMS TO DISPLAY ---
    function loadAll() {
      ["news", "giocatori", "sponsor", "partite", "calendario"].forEach(type => {
        const container = document.getElementById(type + "List");
        if (!container) return;
        const data = JSON.parse(localStorage.getItem(type) || "[]");
        container.innerHTML = "";
        data.forEach((item, i) => {
          const box = document.createElement("div");
          box.className = "item-group";
          for (let key in item) {
            const input = document.createElement("input");
            input.value = item[key];
            input.onchange = () => item[key] = input.value;
            box.appendChild(input);
          }
          const saveBtn = document.createElement("button");
          saveBtn.className = "btn-yellow";
          saveBtn.innerText = "üíæ Salva";
          saveBtn.onclick = () => {
            data[i] = item;
            localStorage.setItem(type, JSON.stringify(data));
            alert("Modificato!");
          };

          const delBtn = document.createElement("button");
          delBtn.className = "btn-red";
          delBtn.innerText = "üóë Elimina";
          delBtn.onclick = () => {
            if (confirm("Eliminare questo elemento?")) {
              data.splice(i, 1);
              localStorage.setItem(type, JSON.stringify(data));
              loadAll();
            }
          };
          box.appendChild(saveBtn);
          box.appendChild(delBtn);
          container.appendChild(box);
        });
      });
    }
  </script>
</body>
</html>
