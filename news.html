<!DOCTYPE html>
<html lang="it">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>News - U.S. Corbiolo C5</title>
  <link rel="stylesheet" href="css/style.css">
</head>
<body>
  <header class="header">
    <img src="img/logo.png" alt="Logo" class="logo">
    <h1 class="page-title">News</h1>
    <div class="menu-icon" onclick="toggleMenu()">â˜°</div>
  </header>

  <div class="popup-menu" id="popupMenu">
    <a href="index.html">ğŸ  Home</a>
    <a href="news.html">ğŸ—ï¸ News</a>
    <a href="squadra.html">ğŸ‘¥ Squadra</a>
    <a href="partite.html">ğŸ“… Partite</a>
    <a href="sponsor.html">ğŸ’° Sponsor</a>
  </div>

  <!-- RIGA NOTIZIE -->
  <div class="box-row" id="news-container">
    <!-- Le notizie verranno caricate qui via JS -->
  </div>

  <!-- CAROSELLO SPONSOR -->
  <div class="footer">
    <div class="sponsor-title">Sponsor</div>
    <div class="carousel-wrapper">
      <div class="carousel-content">
        <img src="img/sponsor1.png" alt="Sponsor 1">
        <img src="img/sponsor2.png" alt="Sponsor 2">
        <img src="img/sponsor3.png" alt="Sponsor 3">
        <img src="img/sponsor1.png" alt="Sponsor 1 clone">
        <img src="img/sponsor2.png" alt="Sponsor 2 clone">
        <img src="img/sponsor3.png" alt="Sponsor 3 clone">
      </div>
    </div>
  </div>

  <script>
    function toggleMenu() {
      const menu = document.getElementById('popupMenu');
      menu.style.display = menu.style.display === 'flex' ? 'none' : 'flex';
    }
  </script>

  <!-- JS per caricare notizie e gestire badge -->
  <script>
    const endpoint = "https://script.google.com/macros/s/AKfycbwmdjLdIbdISpa4ISXRnMk-AreQSeCZggiaHI35rpkdQexhbLzVgEu-P1dLXCBj5B_qUA/exec";
    const container = document.getElementById("news-container");
    const lettoKey = "news_lette";

    function getLetti() {
      return JSON.parse(localStorage.getItem(lettoKey)) || [];
    }

    function setLetto(id) {
      const letti = getLetti();
      if (!letti.includes(id)) {
        letti.push(id);
        localStorage.setItem(lettoKey, JSON.stringify(letti));
      }
    }

    function createNewsCard(news, id) {
      const letti = getLetti();
      const badge = !letti.includes(id) && news.nuova === "SI"
        ? `<span class="badge-news">ğŸŸ¢ NUOVA</span>` : "";

      const card = document.createElement("div");
      card.className = "section";
      card.innerHTML = `
        <img src="${news.img}" alt="${news.titolo}" class="team-logo">
        <div class="section-title-icon">${news.titolo} ${badge}</div>
        <p>${news.testo}</p>
      `;

      card.onclick = () => {
        setLetto(id);
        card.querySelector(".badge-news")?.remove();
      };

      container.appendChild(card);
    }

    fetch(endpoint)
      .then(res => res.json())
      .then(data => {
        const newsList = data.news; // Assicurati che il tuo foglio abbia intestazione 'news'
        newsList.forEach((item, index) => {
          createNewsCard(item, `news${index}`);
        });
      });
  </script>
</body>
</html>
